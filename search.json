[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "bm211-workshops",
    "section": "",
    "text": "Preface to the 2023-24 presentation\nWelcome to the 2023-24 edition of the BM211 computing workshops.\nThis is the first presentation of this material in this form, and we would be very grateful to hear feedback by email or through the GitHub repository Issues page."
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "This is a book created from markdown and executable code.\nSee Knuth (1984) for additional discussion of literate programming.\n\n1 + 1\n\n[1] 2\n\n\n\n\n\n\nKnuth, Donald E. 1984. “Literate Programming.” Comput. J. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97."
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "2  Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "workshop_01.html",
    "href": "workshop_01.html",
    "title": "Workshop 01",
    "section": "",
    "text": "Our goal in this computational workshop is to introduce some concepts in microbial ecology."
  },
  {
    "objectID": "microbial_ecology.html#what-is-microbial-ecology",
    "href": "microbial_ecology.html#what-is-microbial-ecology",
    "title": "3  Microbial Ecology",
    "section": "3.1 What is microbial ecology?",
    "text": "3.1 What is microbial ecology?\nMicrobial ecology is the scientific study of natural microbial communities. It is a hugely important, but arguably underdeveloped area of biology. Important questions remain to be completely answered in detail for many biological systems:\n\n\n\n\n\n\nThe composition of microbial communities\n\n\n\n\n\n\nwhat microbes are found in a community?\nwhat proportion of each microbe species (or other group) is present in a community?\nwhat are the physical limits of the community?\n\n\n\n\n\n\n\n\n\n\ninteractions within the community\n\n\n\n\n\n\nis the community stable (or is it growing, shrinking, or changing composition)?\ndo community members share or compete for resources, and which resources?\ndo the community members effectively operate as a larger-scale system?\n\n\n\n\n\n\n\n\n\n\ninteractions of a community with other organisms\n\n\n\n\n\n\ndoes the gut microbial community influence the host animal’s nutrition, health, or disease status?\ndoes the rhizosphere microbial community influence a plant’s ability to extract nutrition or energy from the environment, and contribute to protection against pathogens?\n\n\n\n\n\n\n\n\n\n\nInteractions between communities\n\n\n\n\n\n\nwhen two communities come together, what does the resulting community look like?\nare there two or more separate (or interacting communities), or do they somehow combine?\n\n\n\n\n\n\n\n\n\n\nEngineering new microbial communities\n\n\n\n\n\n\ncan we predict which microbes can combine into a productive community?\ncan we choose these microbes to engineer a community that achieves a particular goal (e.g. plant protection or gut health)\ncan we perturb existing communities to make them beneficial to health or achieve some other goal?\n\n\n\n\nThis array of questions can be summarised more simply as (Prosser 2020):\n\nWho is there?\nWhat is meant by “there”?\nWho is doing what in there?\nWhat is the effect of doing … to “there”?"
  },
  {
    "objectID": "microbial_ecology.html#answering-questions-about-microbial-ecology-using-molecular-techniques",
    "href": "microbial_ecology.html#answering-questions-about-microbial-ecology-using-molecular-techniques",
    "title": "3  Microbial Ecology",
    "section": "3.2 Answering questions about microbial ecology using molecular techniques",
    "text": "3.2 Answering questions about microbial ecology using molecular techniques\nMolecular techniques enabled by modern sequencing approaches, such as amplicon marker sequencing (e.g. 16S, ITS1 methods) - also known as metabarcoding - and sequencing the entire genomic DNA of a complex sample - also known as metagenomics - have become the dominant approach to understanding microbial community composition (Boughner and Singh 2016). These tools give rapid insights into the complex composition of microbial communities that are unattainable using laborious, time-consuming culture-based techniques.\n\n\n\n\n\n\nMetagenomics vs Metabarcoding\n\n\n\n\n\nThe two words are quite similar, but it is important to distinguish between\n\nmetabarcoding: sequencing a single marker sequence from a population\nmetagenomics: deep sequencing of the entire genomic DNA material in a sample, often attempting to assemble representative genomes from the data\n\n\n\n\nIn addition to their speed and the scale of data they can produce, these molecular techniques have other advantages:\n\nThe (sequence) data collected can be preserved and shared, alongside metadata describing the experiment, in public databases. This enables reanalysis and integration into larger-scale studies.\nFastidious organisms, or those that might be outcompeted in a laboratory culture, can be sequenced and identified.\nOrganisms present in low numbers can be sequenced and identified.\n\n\n\n\n\n\n\nThese molecular techniques answer the question of “Who is there?”, in two ways:\n\nThey tell us what kinds of organism are present (often to species or genus level)\nThey give us a relative count of how much of each kind of organism is present\n\nTaken together, these answers tell us the diversity of the community.\n\n\n\n\n\n\n\n\n\nWe will introduce measures of community diversity in a later section.\n\n\n\n\n3.2.1 Which organisms are present?\nBoth metabarcoding and metagenomics can tell us which microorganisms are present in a biological or environmental sample.\n\n3.2.1.1 Metabarcoding\nIn metabarcoding, we use the polymerase chain reaction (PCR) and primers targeted specifically to amplify a marker sequence: a gene fragment or other stretch of DNA that we believe to be present in all organisms of interest. For bacteria, this is usually a fragment of the 16S rRNA gene. For fungi and other eukaryotic mocroorganisms it may be a fragment of the ITS1 (Internally Transcribed Spacer 1) region.\nThese regions of the genome acquire sequence changes as their organisms evolve over time, such that variants of the marker sequence can be associated with a particular group of microorganisms, usually at the species or genus level. By amplifying and then sequencing the marker sequence from all suitable organisms in the sample, we can identify the marker sequence variants, and then compare these to databases of known sequences, to identify which organisms are present.\n\n\n3.2.1.2 Metagenomics\nA similar principle applies with metagenomics: we sequence the sample and then compare the resulting sequences to a database containing sequences of known organisms, and use this to identify which of them are present in our sample. Differences between the methods arise mainly because this approach is untargeted - we do not know in advance what sequences we will recover - and generates very large amounts of data. Three of the main consequences of this are:\n\nWe can compare individual sequencing reads to the database of known sequences, but due to the large amount of sequence data (in comparison to metabarcoding) we have to do this using special techniques like \\(k\\)-mer alignment, rather than direct sequence comparison (Wood and Salzberg 2014).\nWe can assemble near-complete and complete genomes from the data: Metagenome-Assembled Genomes (MAGs). (Setubal 2021).\nWe can obtain much more information than simple organism identity, such as the presence or absence of individual genes or gene functions, such as antimicrobial resistance genes (Abreu, Perdigão, and Almeida 2020).\n\n\n\n\n3.2.2 How much of each organism is present?\nWhichever method we use to sequence a biological sample, we can obtain a list of the organisms that are present. This tells us something about the composition of the sample, but not everything. There is clearly a difference between one community that is 50% Escherichia coli and 50% Staphylococcus aureus, and another community that is 99% S. aureus and 1% E. coli. But how can we distinguish between the two?\nIn both metabarcoding and metagenomics we can count the number of sequences that correspond to each of the organism types we have identified. For metabarcoding, this might be the count of each amplicon sequence corresponding to a microbial genus. For metagenomics, this might be the number of reads assigned to a microbial species by a tool like Kraken.\n\n\n\n\n\n\nMolecular techniques only estimate organism abundance\n\n\n\n\n\nAll counts of organisms, by both methods, are strictly estimates of the representation of each organism in the sample. There are many factors that influence the way this estimate may very from the actual amount or proportion of any organism in the sample, including:\n\nDNA quality (Manzari et al. 2020)\nlaboratory technique (sample spillover or other handling problems)\nPCR artefacts (especially for low-biomass samples)\nsequence database integrity\nvariable accuracy of associating a sequence with an organism or group (taxonomic misassignment)\n\n\n\n\nWith metagenomic analyses that result in assembled MAGs, an additional way of estimating the amount of each organism present is possible: we can count the number of reads that contribute to each MAG assembly. These reads are then assigned the same identity as that of the MAG itself.\nWe refer to the count of each distinct group of microbes as its abundance."
  },
  {
    "objectID": "microbial_ecology.html#describing-community-composition",
    "href": "microbial_ecology.html#describing-community-composition",
    "title": "3  Microbial Ecology",
    "section": "3.3 Describing community composition",
    "text": "3.3 Describing community composition\nThe list of organisms identified as present in our sample and the (relative) count of how much of the community is composed of each organism, taken together, describe our measured microbial community composition.\n\n\n\n\nAbreu, Vinicius A C de, José Perdigão, and Sintia Almeida. 2020. “Metagenomic Approaches to Analyze Antimicrobial Resistance: An Overview.” Front. Genet. 11: 575592. https://doi.org/10.3389%2Ffgene.2020.575592.\n\n\nBoughner, Lisa A, and Pallavi Singh. 2016. “Microbial Ecology: Where Are We Now?” Postdoc J. 4 (11): 3–17. https://doi.org/10.14304%2FSURYA.JPR.V4N11.2.\n\n\nManzari, Caterina, Annarita Oranger, Bruno Fosso, Elisabetta Piancone, Graziano Pesole, and Anna Maria D’Erchia. 2020. “Accurate Quantification of Bacterial Abundance in Metagenomic DNAs Accounting for Variable DNA Integrity Levels.” Microb. Genom. 6 (10). https://doi.org/10.1099%2Fmgen.0.000417.\n\n\nProsser, James I. 2020. “Putting Science Back into Microbial Ecology: A Question of Approach.” Philos. Trans. R. Soc. Lond. B Biol. Sci. 375 (1798): 20190240. https://doi.org/10.1098/rstb.2019.0240.\n\n\nSetubal, João C. 2021. “Metagenome-Assembled Genomes: Concepts, Analogies, and Challenges.” Biophys. Rev. 13 (6): 905–9. https://doi.org/10.1007/s12551-021-00865-y.\n\n\nWood, Derrick E, and Steven L Salzberg. 2014. “Kraken: Ultrafast Metagenomic Sequence Classification Using Exact Alignments.” Genome Biol. 15 (3): R46. https://doi.org/10.1186/gb-2014-15-3-r46."
  },
  {
    "objectID": "diversity_measures.html#what-is-diversity",
    "href": "diversity_measures.html#what-is-diversity",
    "title": "4  Diversity Measures",
    "section": "4.1 What is diversity?",
    "text": "4.1 What is diversity?\nDiversity measurements for a microbial community are quantitative estimates of how heterogeneous or homogeneous that community is. Qualitative estimates of diversity can be simple. If a community is composed of identical individuals, it is clearly not diverse. However, if the members of a community differ from each other, the community is diverse to some extent.\n\n\n\n\n\n\nDiversity (or the lack of it) is a property of the community, not a property of individuals in the community.\n\n\n\nIf we want to record the level of diversity in a community, or compare it to other communities, we cannot easily rely on qualitative estimates. We need to be more precise than this, and to use quantitative approaches. We need to know what groups are present in the community and, numerically, to what extent each group is represented.\n\n4.1.1 An example community\nTo help illustrate this, we went to Mars1 to obtain a sample (Figure 4.1).\n\n\n\nFigure 4.1: A community sample, obtained from Mars\n\n\nThis community contains a range of individuals of different type, distinguishable by the detailed structure of their outer membranes, and also by their internal contents. The diversity of the community can be seen in (Figure 4.2).\n\n\n\nFigure 4.2: A detailed view of the Mars sample, showing community diversity\n\n\n\n\n\n\n\n\nExercise 1\n\n\n\n\n\n\n\nBy visual inspection of Figure 4.2, how diverse would you say the sample is?\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n\nThere are clearly several different kinds of individual present, so the sample is not homogenous and is diverse in some sense. But in another sense the individuals are all individually-wrapped sweets, so the sample is entirely homogeneous.\nWe clearly need to be more precise about what exactly we mean, when talking about diversity, so that others can understand exactly what we mean."
  },
  {
    "objectID": "diversity_measures.html#community-richness-and-evenness",
    "href": "diversity_measures.html#community-richness-and-evenness",
    "title": "4  Diversity Measures",
    "section": "4.2 Community richness and evenness",
    "text": "4.2 Community richness and evenness\nWe usually define how diverse a community is by using a diversity index. This is a number that reflects the distribution of different types (such as microbial species) of individual that are found in a sample. There are two major concepts that contribute to diversity indices.\n\n\n\n\n\n\nRichness\n\n\n\n\n\nThe richness of a sample is the number of different types that are represented in the sample.\nFor example, species richness is a count of the total number of species in the sample. It does not take into acount species abundance, or relative abundance.\n\n\n\n\n\n\n\n\n\nEvenness\n\n\n\n\n\nThe evenness of a sample reflects how similar is the abundance of each type of thing in the sample. The more similar the proportion of each type, the more even the community.\nFor example, species evenness reflects the relative abundances of distinct species in the sample. If a sample contains three species: \\(A\\), \\(B\\), and \\(C\\), then:\n\na sample with 33% \\(A\\), 33% \\(B\\), and 33% \\(C\\) has high species evenness\na sample with 5% \\(A\\), 90% \\(B\\), and 5% \\(C\\) has low species evenness"
  },
  {
    "objectID": "diversity_measures.html#richness-and-evenness-in-the-mars-sample",
    "href": "diversity_measures.html#richness-and-evenness-in-the-mars-sample",
    "title": "4  Diversity Measures",
    "section": "4.3 Richness and evenness in the Mars sample",
    "text": "4.3 Richness and evenness in the Mars sample\nWe can organise the individuals in the Mars sample, as shown in Figure 4.3. This gives us enough information to calculate species richness and evenness for this community.\n\n\n\nFigure 4.3: Species abundance in the Mars sample community\n\n\n\n4.3.1 Species richness\nWe can easily count the number of different species, as determined by morphology and membrane features, in Figure 4.3. There are eight (8) species, and this is a quantitative measure of species richness.\nTaken in isolation though, this number doesn’t tell us very much. We would need other information - maybe from other samples - to know whether eight is a large, small, or intermediate number of species. Nor does this number tell us whether all species are represented to the same extent (even if, from looking at Figure 4.3 we can tell they are not). We need to consider evenness for that.\n\n\n4.3.2 Species evenness\nWe can see visually from Figure 4.3 that there are not equal amounts of each species, so the community is not perfectly even in terms of species evenness. But the question remains open: how do we combine richness and evenness together into an index or number, to understand species diversity in our sample?\n\n\n\n\n\n\nWe will discuss a simple measure of species diversity, Shannon Index, in the next chapter."
  },
  {
    "objectID": "diversity_measures.html#footnotes",
    "href": "diversity_measures.html#footnotes",
    "title": "4  Diversity Measures",
    "section": "",
    "text": "OK, we actually went to Sainsbury’s Local. The one on Buchanan Street. But the sweets are technically from Mars.↩︎"
  },
  {
    "objectID": "shannon_index.html#what-is-the-shannon-index",
    "href": "shannon_index.html#what-is-the-shannon-index",
    "title": "5  Shannon Index",
    "section": "5.1 What is the Shannon index?",
    "text": "5.1 What is the Shannon index?\nThe Shannon Index (\\(H\\)) is arguably the simplest measure of community diversity. It is described by Equation 5.1, and varies between a value close to zero (for very uneven communities), and \\(ln(1/N)\\) for an community with \\(N\\) evenly-distributed species. The way that the maximum value of Shannon Index varies with species richness (count of species) is shown in Figure 5.1.\n\n\n\n\n\nFigure 5.1: Plot of maximum Shannon Index against community richness\n\n\n\n\n\n5.1.1 What does the equation for Shannon Index mean?\nThe Shannon Index describes the evenness of species in a community. Representing one species from the community as \\(i\\), we can calculate the relative abundance of that species in the community as its richness (count of species \\(i\\)) divided by the total abundance for all species. We call this relative abundance \\(p_i\\).\nThe Shannon Index takes this number and transforms it mathematically (as in Equation 5.1) so that the resulting value \\(H\\) varies between zero (maximally uneven), and some maximum value (maximally even), as represented in Figure 5.1. Knowing the richness (total number of species) for a community and the Shannon Index (\\(H\\)), we can quantify how diverse our community is.\n\\[\nH = -\\sum_{i=1}^{N} p_i \\ln(p_i)\n\\tag{5.1}\\]\n\n\n5.1.2 Calculating Shannon Index\nLet’s start in R by defining our dataset for the Mars community. In the code below we do this by creating two vectors: one of species names, and one of counts for those species in our sample. We combine these vectors into a single dataframe, for convenience.\n\n# Define a vector of species names\nspecies &lt;- c(\"Malteaser sp.\", \"Snickers sp.\", \"Twix sp.\", \"Mars sp.\",\n            \"Milky way\", \"Bounty sp.\", \"Galaxy choc\", \"Galaxy caramel\")\n\n# Define a vector of corresponding species counts\ncount &lt;- c(3, 6, 6, 7, 7, 5, 3, 3)\n\n# Bring these together in a dataframe\ncommunity.df &lt;- data.frame(species, count)\n\nWe can inspect the dataframe, to make sure we have the correct data:\n\ncommunity.df\n\n         species count\n1  Malteaser sp.     3\n2   Snickers sp.     6\n3       Twix sp.     6\n4       Mars sp.     7\n5      Milky way     7\n6     Bounty sp.     5\n7    Galaxy choc     3\n8 Galaxy caramel     3\n\n\nThe first step in calculating Shannon Index is to calculate the relative abundance of each species. To do this, we calculate the percentage of the entire community that is made up from each species, as below. We divide the count for each species by the sum of counts for all species (i.e. the total number of individuals, in this case).\n\n# Calculate relative abundances\ncommunity.df$rel_abd &lt;- community.df$count / sum(community.df$count)\n\n# Show the data frame\ncommunity.df\n\n         species count rel_abd\n1  Malteaser sp.     3   0.075\n2   Snickers sp.     6   0.150\n3       Twix sp.     6   0.150\n4       Mars sp.     7   0.175\n5      Milky way     7   0.175\n6     Bounty sp.     5   0.125\n7    Galaxy choc     3   0.075\n8 Galaxy caramel     3   0.075\n\n\nTo turn this data into the Shannon Index, we need to carry out two more steps: calculate the natural log of the relative abundance of each species, then multiply this by the corresponding relative abundance, as in the R code below:\n\n# Calculate the natural log of relative abundance\ncommunity.df$ln_rel_abd &lt;- log(community.df$rel_abd)\n\n# Multiply the relative abundance by its natural log\ncommunity.df$mult &lt;- community.df$rel_abd * log(community.df$rel_abd)\n\n# Show the result\ncommunity.df\n\n         species count rel_abd ln_rel_abd       mult\n1  Malteaser sp.     3   0.075  -2.590267 -0.1942700\n2   Snickers sp.     6   0.150  -1.897120 -0.2845680\n3       Twix sp.     6   0.150  -1.897120 -0.2845680\n4       Mars sp.     7   0.175  -1.742969 -0.3050196\n5      Milky way     7   0.175  -1.742969 -0.3050196\n6     Bounty sp.     5   0.125  -2.079442 -0.2599302\n7    Galaxy choc     3   0.075  -2.590267 -0.1942700\n8 Galaxy caramel     3   0.075  -2.590267 -0.1942700\n\n\nThe Shannon Index is then the sum of this final column of values (multiplied by -1 to make it a positive value).\n\nshannon_index = -sum(community.df$mult)\nshannon_index\n\n[1] 2.021916"
  },
  {
    "objectID": "workshop_04.html",
    "href": "workshop_04.html",
    "title": "Workshop 04",
    "section": "",
    "text": "Our goal in this workshop is to introduce you to handling and analysing CRISPR-Cas sequence data."
  },
  {
    "objectID": "piler_cr.html",
    "href": "piler_cr.html",
    "title": "PILER-CR",
    "section": "",
    "text": "This chapter will introduce the software tool PILER-CR, which is designed to predict the location and content of CRISPR repeats in microbial genomes."
  },
  {
    "objectID": "workshop_05.html",
    "href": "workshop_05.html",
    "title": "Workshop 05",
    "section": "",
    "text": "Our goal in this workshop is to introduce you to producing and interpreting phylogenetic trees."
  },
  {
    "objectID": "protein_trees.html",
    "href": "protein_trees.html",
    "title": "Protein Trees",
    "section": "",
    "text": "This chapter will guide you through the process of producing a phylogenetic tree from a protein sequence alignment."
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Abreu, Vinicius A C de, José Perdigão, and Sintia Almeida. 2020.\n“Metagenomic Approaches to Analyze Antimicrobial Resistance: An\nOverview.” Front. Genet. 11: 575592. https://doi.org/10.3389%2Ffgene.2020.575592.\n\n\nBoughner, Lisa A, and Pallavi Singh. 2016. “Microbial Ecology:\nWhere Are We Now?” Postdoc J. 4 (11): 3–17. https://doi.org/10.14304%2FSURYA.JPR.V4N11.2.\n\n\nKnuth, Donald E. 1984. “Literate Programming.” Comput.\nJ. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97.\n\n\nManzari, Caterina, Annarita Oranger, Bruno Fosso, Elisabetta Piancone,\nGraziano Pesole, and Anna Maria D’Erchia. 2020. “Accurate\nQuantification of Bacterial Abundance in Metagenomic DNAs\nAccounting for Variable DNA Integrity Levels.”\nMicrob. Genom. 6 (10). https://doi.org/10.1099%2Fmgen.0.000417.\n\n\nProsser, James I. 2020. “Putting Science Back into Microbial\nEcology: A Question of Approach.” Philos. Trans. R. Soc.\nLond. B Biol. Sci. 375 (1798): 20190240. https://doi.org/10.1098/rstb.2019.0240.\n\n\nSetubal, João C. 2021. “Metagenome-Assembled Genomes: Concepts,\nAnalogies, and Challenges.” Biophys. Rev. 13 (6): 905–9.\nhttps://doi.org/10.1007/s12551-021-00865-y.\n\n\nWood, Derrick E, and Steven L Salzberg. 2014. “Kraken: Ultrafast\nMetagenomic Sequence Classification Using Exact Alignments.”\nGenome Biol. 15 (3): R46. https://doi.org/10.1186/gb-2014-15-3-r46."
  }
]